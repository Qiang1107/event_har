=== Time Window Voting Prediction System ===
Model type: pointnet2msg
Time window: 0.5 seconds
Verbose window output: False
Voting method: Simple majority voting
Data source: preprocessing_data/test_data_0628_8_ecount_3_vote.pkl
Config file: configs/har_test_config.yaml
Model file: results/checkpoints/pointnet2_event_0628_8_ecount_11.pth

Start time: 2025-09-11 18:57:18

Using device: cuda:0
Model loaded successfully: results/checkpoints/pointnet2_event_0628_8_ecount_11.pth

Loading vote dataset: preprocessing_data/test_data_0628_8_ecount_3_vote.pkl
Loaded 11278 samples with timestamps
Starting prediction for 11278 samples...
Grouping predictions by 0.5s time windows...
Performing majority voting in 451 time windows...

=== Mixed Label Window 3502222817 - Splitting ===
Original window: 34 samples with labels [0, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 3502222817_sub_0_label_0):
    True label: 0
    Samples: 9
    Final prediction: 0
    Vote count: 8/9 (88.9%)
    Prediction distribution: {0: 8, 7: 1}
    Result: CORRECT
    Time range: 1751111408877767 - 1751111408995573 microseconds
  Sub-window 2 (ID: 3502222817_sub_1_label_7):
    True label: 7
    Samples: 25
    Final prediction: 7
    Vote count: 25/25 (100.0%)
    Prediction distribution: {7: 25}
    Result: CORRECT
    Time range: 1751111408501408 - 1751111408738729 microseconds
Mixed window 3502222817 successfully split into 2 sub-windows

!!! INCORRECT Window 3502222825 !!!
True label: 4, Final prediction: 2
Total samples: 1, Vote count: 1/1
Prediction distribution: {2: 1}

!!! INCORRECT Window 3502222847 !!!
True label: 0, Final prediction: 7
Total samples: 20, Vote count: 12/20
Prediction distribution: {7: 12, 5: 1, 0: 5, 2: 2}

=== Mixed Label Window 3502223702 - Splitting ===
Original window: 23 samples with labels [5, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 3502223702_sub_0_label_5):
    True label: 5
    Samples: 16
    Final prediction: 5
    Vote count: 15/16 (93.8%)
    Prediction distribution: {5: 15, 3: 1}
    Result: CORRECT
    Time range: 1751111851003676 - 1751111851303988 microseconds
  Sub-window 2 (ID: 3502223702_sub_1_label_7):
    True label: 7
    Samples: 7
    Final prediction: 7
    Vote count: 7/7 (100.0%)
    Prediction distribution: {7: 7}
    Result: CORRECT
    Time range: 1751111851453039 - 1751111851497868 microseconds
Mixed window 3502223702 successfully split into 2 sub-windows

=== Mixed Label Window 3502223876 - Splitting ===
Original window: 17 samples with labels [5, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 3502223876_sub_0_label_5):
    True label: 5
    Samples: 9
    Final prediction: 5
    Vote count: 8/9 (88.9%)
    Prediction distribution: {5: 8, 3: 1}
    Result: CORRECT
    Time range: 1751111938022085 - 1751111938266254 microseconds
  Sub-window 2 (ID: 3502223876_sub_1_label_7):
    True label: 7
    Samples: 8
    Final prediction: 7
    Vote count: 8/8 (100.0%)
    Prediction distribution: {7: 8}
    Result: CORRECT
    Time range: 1751111938438508 - 1751111938497922 microseconds
Mixed window 3502223876 successfully split into 2 sub-windows

!!! INCORRECT Window 3502223983 !!!
True label: 2, Final prediction: 4
Total samples: 42, Vote count: 22/42
Prediction distribution: {2: 20, 4: 22}

=== Mixed Label Window 3502224140 - Splitting ===
Original window: 36 samples with labels [3, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 3502224140_sub_0_label_3):
    True label: 3
    Samples: 6
    Final prediction: 3
    Vote count: 6/6 (100.0%)
    Prediction distribution: {3: 6}
    Result: CORRECT
    Time range: 1751112070005326 - 1751112070186448 microseconds
  Sub-window 2 (ID: 3502224140_sub_1_label_7):
    True label: 7
    Samples: 30
    Final prediction: 7
    Vote count: 29/30 (96.7%)
    Prediction distribution: {3: 1, 7: 29}
    Result: CORRECT
    Time range: 1751112070280762 - 1751112070493021 microseconds
Mixed window 3502224140 successfully split into 2 sub-windows

!!! INCORRECT Window 3502224270 !!!
True label: 3, Final prediction: 5
Total samples: 3, Vote count: 2/3
Prediction distribution: {0: 1, 5: 2}

!!! INCORRECT Window 3502224286 !!!
True label: 0, Final prediction: 7
Total samples: 8, Vote count: 8/8
Prediction distribution: {7: 8}

!!! INCORRECT Window 3502224483 !!!
True label: 6, Final prediction: 5
Total samples: 8, Vote count: 5/8
Prediction distribution: {5: 5, 6: 3}

=== Mixed Label Window 3502224772 - Splitting ===
Original window: 30 samples with labels [5, 6]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 3502224772_sub_0_label_5):
    True label: 5
    Samples: 25
    Final prediction: 5
    Vote count: 25/25 (100.0%)
    Prediction distribution: {5: 25}
    Result: CORRECT
    Time range: 1751112386220304 - 1751112386494176 microseconds
  Sub-window 2 (ID: 3502224772_sub_1_label_6):
    True label: 6
    Samples: 5
    Final prediction: 6
    Vote count: 5/5 (100.0%)
    Prediction distribution: {6: 5}
    Result: CORRECT
    Time range: 1751112386010113 - 1751112386089494 microseconds
Mixed window 3502224772 successfully split into 2 sub-windows

!!! INCORRECT Window 3502224930 !!!
True label: 5, Final prediction: 0
Total samples: 9, Vote count: 5/9
Prediction distribution: {0: 5, 5: 2, 3: 2}

!!! INCORRECT Window 3502226809 !!!
True label: 3, Final prediction: 4
Total samples: 4, Vote count: 2/4
Prediction distribution: {4: 2, 2: 1, 1: 1}

=== Mixed Label Window 3502229266 - Splitting ===
Original window: 29 samples with labels [0, 3]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 3502229266_sub_0_label_0):
    True label: 0
    Samples: 4
    Final prediction: 0
    Vote count: 4/4 (100.0%)
    Prediction distribution: {0: 4}
    Result: CORRECT
    Time range: 1751114633001643 - 1751114633083998 microseconds
  Sub-window 2 (ID: 3502229266_sub_1_label_3):
    True label: 3
    Samples: 25
    Final prediction: 3
    Vote count: 25/25 (100.0%)
    Prediction distribution: {3: 25}
    Result: CORRECT
    Time range: 1751114633270443 - 1751114633495431 microseconds
Mixed window 3502229266 successfully split into 2 sub-windows

!!! INCORRECT Window 3502230587 !!!
True label: 1, Final prediction: 5
Total samples: 5, Vote count: 4/5
Prediction distribution: {5: 4, 1: 1}

=== Inference Time Statistics ===
Total samples: 11278
Pure inference time: 26.1551 seconds
Average inference time per sample: 0.002319 seconds
Inference throughput: 431.20 samples/second

=== Time Window Processing Summary ===
Total original time windows found: 451
Mixed label windows (split): 6
Pure single-label windows: 445
Total final windows after splitting: 457
Final window breakdown:
  - Original single-label windows: 445
  - Sub-windows from mixed splitting: 12
Window statistics:
  - Samples per window: min=1, max=136, avg=24.7
  - Correct windows: 448/457 (98.0%)
  - Vote consistency: min=0.500, max=1.000, avg=0.974
Mixed label time windows processed: 6/451 (1.3%) - split into sub-windows
Total final windows for analysis: 457
Prediction completed, elapsed time: 27.74 seconds

=== Time Window Voting Results Analysis ===
Number of time windows: 457
Number of individual predictions: 11278
Individual sample accuracy: 0.9719 (97.19%)
Time window voting accuracy: 0.9803 (98.03%)
Accuracy improvement: +0.0084 (+0.84%)

=== Inference Performance Statistics ===
Total samples: 11278
Pure inference time: 26.1551 seconds
Average inference time per sample: 0.002319 seconds
Inference throughput: 431.20 samples/second

=== Voting Statistics ===
Predictions per window - Average: 24.7, Min: 1, Max: 136
Voting consistency - Average: 0.974, Min: 0.500, Max: 1.000
Mixed label windows: 6/451 (1.3%) - split into sub-windows
Total analysis windows (including split sub-windows): 457/451 original windows

=== Per-class Performance After Majority Voting ===
Class                          Windows  Accuracy  
--------------------------------------------------
Approach                       90       97.78%
Pick_and_Place_Bolt            46       97.83%
Pick_and_Place_Cover           55       98.18%
Pick_and_Place_Part1_Small     31       93.55%
Pick_and_Place_Part2_Big       42       97.62%
Pick_and_Place_Screwdriver     64       98.44%
Screw                          70       98.57%
Transition                     59       100.00%

=== Individual Sample Per-class Performance ===
Class                          Samples  Accuracy  
--------------------------------------------------
Approach                       2677     97.12%
Pick_and_Place_Bolt            937      94.77%
Pick_and_Place_Cover           1731     97.57%
Pick_and_Place_Part1_Small     708      95.34%
Pick_and_Place_Part2_Big       1184     98.48%
Pick_and_Place_Screwdriver     1877     97.02%
Screw                          493      97.97%
Transition                     1671     98.08%

=== Window-level Confusion Matrix ===
88,0,0,0,0,0,0,2
0,45,0,0,0,1,0,0
0,0,54,0,1,0,0,0
0,0,0,29,1,1,0,0
0,0,1,0,41,0,0,0
1,0,0,0,0,63,0,0
0,0,0,0,0,1,69,0
0,0,0,0,0,0,0,59

=== Window-level Normalized Confusion Matrix ===
0.98,0.00,0.00,0.00,0.00,0.00,0.00,0.02
0.00,0.98,0.00,0.00,0.00,0.02,0.00,0.00
0.00,0.00,0.98,0.00,0.02,0.00,0.00,0.00
0.00,0.00,0.00,0.94,0.03,0.03,0.00,0.00
0.00,0.00,0.02,0.00,0.98,0.00,0.00,0.00
0.02,0.00,0.00,0.00,0.00,0.98,0.00,0.00
0.00,0.00,0.00,0.00,0.00,0.01,0.99,0.00
0.00,0.00,0.00,0.00,0.00,0.00,0.00,1.00

=== Individual Sample Confusion Matrix ===
2600,0,12,9,7,7,0,42
0,888,1,28,0,19,1,0
0,3,1689,1,37,1,0,0
3,4,1,675,6,19,0,0
0,0,5,13,1166,0,0,0
20,19,2,4,1,1821,5,5
0,0,1,0,0,9,483,0
24,0,0,7,0,1,0,1639

=== Individual Sample Normalized Confusion Matrix ===
0.97,0.00,0.00,0.00,0.00,0.00,0.00,0.02
0.00,0.95,0.00,0.03,0.00,0.02,0.00,0.00
0.00,0.00,0.98,0.00,0.02,0.00,0.00,0.00
0.00,0.01,0.00,0.95,0.01,0.03,0.00,0.00
0.00,0.00,0.00,0.01,0.98,0.00,0.00,0.00
0.01,0.01,0.00,0.00,0.00,0.97,0.00,0.00
0.00,0.00,0.00,0.00,0.00,0.02,0.98,0.00
0.01,0.00,0.00,0.00,0.00,0.00,0.00,0.98

Confusion matrix image paths:
Window-level: results/test_figs/pointnet2_event_0628_8_ecount_11_window_confusion_matrix_time_window_sec_0.5s_20250911_185718.png
Window-level normalized: results/test_figs/pointnet2_event_0628_8_ecount_11_window_norm_confusion_matrix_0.5s_20250911_185718.png
Individual sample: results/test_figs/pointnet2_event_0628_8_ecount_11_individual_confusion_matrix_0.5s_20250911_185718.png
Individual sample normalized: results/test_figs/pointnet2_event_0628_8_ecount_11_individual_norm_confusion_matrix_0.5s_20250911_185718.png

=== Key Metrics ===
Number of time windows: 457
Number of individual predictions: 11278
Individual sample accuracy: 97.19%
Time window voting accuracy: 98.03%
Accuracy improvement: +0.84%
Prediction time: 27.74 seconds
Pure inference time: 26.1551 seconds
Average inference time per sample: 0.002319 seconds
Inference throughput: 431.20 samples/second

End time: 2025-09-11 18:57:47

=== Results Summary ===
Time window voting accuracy: 98.03%
Individual sample accuracy: 97.19%
Accuracy improvement: +0.84%
Pure inference time: 26.1551 seconds
Average inference time per sample: 0.002319 seconds
Inference throughput: 431.20 samples/second
Log file: results/test_logs/voting_0.5s_20250911_185718.txt
