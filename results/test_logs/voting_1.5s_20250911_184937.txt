=== Time Window Voting Prediction System ===
Model type: pointnet2msg
Time window: 1.5 seconds
Verbose window output: False
Voting method: Simple majority voting
Data source: preprocessing_data/test_data_0628_8_ecount_3_vote.pkl
Config file: configs/har_test_config.yaml
Model file: results/checkpoints/pointnet2_event_0628_8_ecount_11.pth

Start time: 2025-09-11 18:49:37

Using device: cuda:0
Model loaded successfully: results/checkpoints/pointnet2_event_0628_8_ecount_11.pth

Loading vote dataset: preprocessing_data/test_data_0628_8_ecount_3_vote.pkl
Loaded 11278 samples with timestamps
Starting prediction for 11278 samples...
Grouping predictions by 1.5s time windows...
Performing majority voting in 216 time windows...

=== Mixed Label Window 1167407605 - Splitting ===
Original window: 62 samples with labels [0, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167407605_sub_0_label_0):
    True label: 0
    Samples: 9
    Final prediction: 0
    Vote count: 9/9 (100.0%)
    Prediction distribution: {0: 9}
    Result: CORRECT
    Time range: 1751111408877767 - 1751111408995573 microseconds
  Sub-window 2 (ID: 1167407605_sub_1_label_7):
    True label: 7
    Samples: 53
    Final prediction: 7
    Vote count: 53/53 (100.0%)
    Prediction distribution: {7: 53}
    Result: CORRECT
    Time range: 1751111408308062 - 1751111408738729 microseconds
Mixed window 1167407605 successfully split into 2 sub-windows

=== Mixed Label Window 1167407606 - Splitting ===
Original window: 125 samples with labels [0, 4]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167407606_sub_0_label_0):
    True label: 0
    Samples: 32
    Final prediction: 0
    Vote count: 32/32 (100.0%)
    Prediction distribution: {0: 32}
    Result: CORRECT
    Time range: 1751111409006238 - 1751111409396310 microseconds
  Sub-window 2 (ID: 1167407606_sub_1_label_4):
    True label: 4
    Samples: 93
    Final prediction: 4
    Vote count: 93/93 (100.0%)
    Prediction distribution: {4: 93}
    Result: CORRECT
    Time range: 1751111409620339 - 1751111410483748 microseconds
Mixed window 1167407606 successfully split into 2 sub-windows

!!! INCORRECT Window 1167407615 !!!
True label: 0, Final prediction: 7
Total samples: 20, Vote count: 13/20
Prediction distribution: {7: 13, 5: 1, 0: 5, 2: 1}

=== Mixed Label Window 1167407899 - Splitting ===
Original window: 100 samples with labels [5, 6]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167407899_sub_0_label_5):
    True label: 5
    Samples: 96
    Final prediction: 5
    Vote count: 87/96 (90.6%)
    Prediction distribution: {6: 7, 5: 87, 0: 2}
    Result: CORRECT
    Time range: 1751111849011005 - 1751111849986638 microseconds
  Sub-window 2 (ID: 1167407899_sub_1_label_6):
    True label: 6
    Samples: 4
    Final prediction: 6
    Vote count: 4/4 (100.0%)
    Prediction distribution: {6: 4}
    Result: CORRECT
    Time range: 1751111848573144 - 1751111848725659 microseconds
Mixed window 1167407899 successfully split into 2 sub-windows

=== Mixed Label Window 1167407900 - Splitting ===
Original window: 126 samples with labels [5, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167407900_sub_0_label_5):
    True label: 5
    Samples: 119
    Final prediction: 5
    Vote count: 117/119 (98.3%)
    Prediction distribution: {5: 117, 2: 1, 3: 1}
    Result: CORRECT
    Time range: 1751111850001850 - 1751111851303988 microseconds
  Sub-window 2 (ID: 1167407900_sub_1_label_7):
    True label: 7
    Samples: 7
    Final prediction: 7
    Vote count: 7/7 (100.0%)
    Prediction distribution: {7: 7}
    Result: CORRECT
    Time range: 1751111851453039 - 1751111851497868 microseconds
Mixed window 1167407900 successfully split into 2 sub-windows

=== Mixed Label Window 1167407958 - Splitting ===
Original window: 93 samples with labels [5, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167407958_sub_0_label_5):
    True label: 5
    Samples: 85
    Final prediction: 5
    Vote count: 85/85 (100.0%)
    Prediction distribution: {5: 85}
    Result: CORRECT
    Time range: 1751111937021257 - 1751111938266254 microseconds
  Sub-window 2 (ID: 1167407958_sub_1_label_7):
    True label: 7
    Samples: 8
    Final prediction: 7
    Vote count: 8/8 (100.0%)
    Prediction distribution: {7: 8}
    Result: CORRECT
    Time range: 1751111938438508 - 1751111938497922 microseconds
Mixed window 1167407958 successfully split into 2 sub-windows

=== Mixed Label Window 1167408046 - Splitting ===
Original window: 77 samples with labels [3, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167408046_sub_0_label_3):
    True label: 3
    Samples: 47
    Final prediction: 3
    Vote count: 47/47 (100.0%)
    Prediction distribution: {3: 47}
    Result: CORRECT
    Time range: 1751112069010404 - 1751112070186448 microseconds
  Sub-window 2 (ID: 1167408046_sub_1_label_7):
    True label: 7
    Samples: 30
    Final prediction: 7
    Vote count: 29/30 (96.7%)
    Prediction distribution: {3: 1, 7: 29}
    Result: CORRECT
    Time range: 1751112070280762 - 1751112070493021 microseconds
Mixed window 1167408046 successfully split into 2 sub-windows

=== Mixed Label Window 1167408257 - Splitting ===
Original window: 85 samples with labels [5, 6]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167408257_sub_0_label_5):
    True label: 5
    Samples: 69
    Final prediction: 5
    Vote count: 69/69 (100.0%)
    Prediction distribution: {5: 69}
    Result: CORRECT
    Time range: 1751112386220304 - 1751112386993103 microseconds
  Sub-window 2 (ID: 1167408257_sub_1_label_6):
    True label: 6
    Samples: 16
    Final prediction: 6
    Vote count: 16/16 (100.0%)
    Prediction distribution: {6: 16}
    Result: CORRECT
    Time range: 1751112385516206 - 1751112386089494 microseconds
Mixed window 1167408257 successfully split into 2 sub-windows

!!! INCORRECT Window 1167408310 !!!
True label: 5, Final prediction: 0
Total samples: 9, Vote count: 4/9
Prediction distribution: {5: 3, 0: 4, 3: 1, 2: 1}

=== Mixed Label Window 1167409754 - Splitting ===
Original window: 7 samples with labels [0, 5]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167409754_sub_0_label_0):
    True label: 0
    Samples: 1
    Final prediction: 0
    Vote count: 1/1 (100.0%)
    Prediction distribution: {0: 1}
    Result: CORRECT
    Time range: 1751114632481310 - 1751114632481310 microseconds
  Sub-window 2 (ID: 1167409754_sub_1_label_5):
    True label: 5
    Samples: 6
    Final prediction: 5
    Vote count: 6/6 (100.0%)
    Prediction distribution: {5: 6}
    Result: CORRECT
    Time range: 1751114631015532 - 1751114631201430 microseconds
Mixed window 1167409754 successfully split into 2 sub-windows

=== Mixed Label Window 1167409755 - Splitting ===
Original window: 128 samples with labels [0, 3]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167409755_sub_0_label_0):
    True label: 0
    Samples: 47
    Final prediction: 0
    Vote count: 47/47 (100.0%)
    Prediction distribution: {0: 47}
    Result: CORRECT
    Time range: 1751114632500044 - 1751114633083998 microseconds
  Sub-window 2 (ID: 1167409755_sub_1_label_3):
    True label: 3
    Samples: 81
    Final prediction: 3
    Vote count: 81/81 (100.0%)
    Prediction distribution: {3: 81}
    Result: CORRECT
    Time range: 1751114633270443 - 1751114633982004 microseconds
Mixed window 1167409755 successfully split into 2 sub-windows

=== Mixed Label Window 1167409827 - Splitting ===
Original window: 59 samples with labels [0, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167409827_sub_0_label_0):
    True label: 0
    Samples: 43
    Final prediction: 0
    Vote count: 43/43 (100.0%)
    Prediction distribution: {0: 43}
    Result: CORRECT
    Time range: 1751114741153844 - 1751114741840099 microseconds
  Sub-window 2 (ID: 1167409827_sub_1_label_7):
    True label: 7
    Samples: 16
    Final prediction: 7
    Vote count: 16/16 (100.0%)
    Prediction distribution: {7: 16}
    Result: CORRECT
    Time range: 1751114740508180 - 1751114740863500 microseconds
Mixed window 1167409827 successfully split into 2 sub-windows

=== Mixed Label Window 1167409859 - Splitting ===
Original window: 99 samples with labels [0, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167409859_sub_0_label_0):
    True label: 0
    Samples: 30
    Final prediction: 0
    Vote count: 30/30 (100.0%)
    Prediction distribution: {0: 30}
    Result: CORRECT
    Time range: 1751114789556822 - 1751114789998106 microseconds
  Sub-window 2 (ID: 1167409859_sub_1_label_7):
    True label: 7
    Samples: 69
    Final prediction: 7
    Vote count: 69/69 (100.0%)
    Prediction distribution: {7: 69}
    Result: CORRECT
    Time range: 1751114788668197 - 1751114789296598 microseconds
Mixed window 1167409859 successfully split into 2 sub-windows

=== Mixed Label Window 1167409979 - Splitting ===
Original window: 135 samples with labels [4, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167409979_sub_0_label_4):
    True label: 4
    Samples: 8
    Final prediction: 4
    Vote count: 8/8 (100.0%)
    Prediction distribution: {4: 8}
    Result: CORRECT
    Time range: 1751114968511215 - 1751114968955961 microseconds
  Sub-window 2 (ID: 1167409979_sub_1_label_7):
    True label: 7
    Samples: 127
    Final prediction: 7
    Vote count: 127/127 (100.0%)
    Prediction distribution: {7: 127}
    Result: CORRECT
    Time range: 1751114969254360 - 1751114969950858 microseconds
Mixed window 1167409979 successfully split into 2 sub-windows

=== Mixed Label Window 1167409982 - Splitting ===
Original window: 93 samples with labels [0, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167409982_sub_0_label_0):
    True label: 0
    Samples: 60
    Final prediction: 0
    Vote count: 60/60 (100.0%)
    Prediction distribution: {0: 60}
    Result: CORRECT
    Time range: 1751114974006239 - 1751114974494714 microseconds
  Sub-window 2 (ID: 1167409982_sub_1_label_7):
    True label: 7
    Samples: 33
    Final prediction: 7
    Vote count: 33/33 (100.0%)
    Prediction distribution: {7: 33}
    Result: CORRECT
    Time range: 1751114973648706 - 1751114973876889 microseconds
Mixed window 1167409982 successfully split into 2 sub-windows

=== Mixed Label Window 1167410132 - Splitting ===
Original window: 111 samples with labels [4, 7]
Splitting into 2 sub-windows by true label:
  Sub-window 1 (ID: 1167410132_sub_0_label_4):
    True label: 4
    Samples: 6
    Final prediction: 4
    Vote count: 6/6 (100.0%)
    Prediction distribution: {4: 6}
    Result: CORRECT
    Time range: 1751115198013366 - 1751115198312126 microseconds
  Sub-window 2 (ID: 1167410132_sub_1_label_7):
    True label: 7
    Samples: 105
    Final prediction: 7
    Vote count: 105/105 (100.0%)
    Prediction distribution: {7: 105}
    Result: CORRECT
    Time range: 1751115198587372 - 1751115199308850 microseconds
Mixed window 1167410132 successfully split into 2 sub-windows

=== Inference Time Statistics ===
Total samples: 11278
Pure inference time: 40.1993 seconds
Average inference time per sample: 0.003564 seconds
Inference throughput: 280.55 samples/second

=== Time Window Processing Summary ===
Total original time windows found: 216
Mixed label windows (split): 14
Pure single-label windows: 202
Total final windows after splitting: 230
Final window breakdown:
  - Original single-label windows: 202
  - Sub-windows from mixed splitting: 28
Window statistics:
  - Samples per window: min=1, max=251, avg=49.0
  - Correct windows: 228/230 (99.1%)
  - Vote consistency: min=0.444, max=1.000, avg=0.969
Mixed label time windows processed: 14/216 (6.5%) - split into sub-windows
Total final windows for analysis: 230
Prediction completed, elapsed time: 45.73 seconds

=== Time Window Voting Results Analysis ===
Number of time windows: 230
Number of individual predictions: 11278
Individual sample accuracy: 0.9737 (97.37%)
Time window voting accuracy: 0.9913 (99.13%)
Accuracy improvement: +0.0176 (+1.76%)

=== Inference Performance Statistics ===
Total samples: 11278
Pure inference time: 40.1993 seconds
Average inference time per sample: 0.003564 seconds
Inference throughput: 280.55 samples/second

=== Voting Statistics ===
Predictions per window - Average: 49.0, Min: 1, Max: 251
Voting consistency - Average: 0.969, Min: 0.444, Max: 1.000
Mixed label windows: 14/216 (6.5%) - split into sub-windows
Total analysis windows (including split sub-windows): 230/216 original windows

=== Per-class Performance After Majority Voting ===
Class                          Windows  Accuracy  
--------------------------------------------------
Approach                       53       98.11%
Pick_and_Place_Bolt            18       100.00%
Pick_and_Place_Cover           22       100.00%
Pick_and_Place_Part1_Small     14       100.00%
Pick_and_Place_Part2_Big       21       100.00%
Pick_and_Place_Screwdriver     31       96.77%
Screw                          28       100.00%
Transition                     43       100.00%

=== Individual Sample Per-class Performance ===
Class                          Samples  Accuracy  
--------------------------------------------------
Approach                       2677     97.42%
Pick_and_Place_Bolt            937      95.41%
Pick_and_Place_Cover           1731     97.63%
Pick_and_Place_Part1_Small     708      95.62%
Pick_and_Place_Part2_Big       1184     98.65%
Pick_and_Place_Screwdriver     1877     96.96%
Screw                          493      98.38%
Transition                     1671     98.08%

=== Window-level Confusion Matrix ===
52,0,0,0,0,0,0,1
0,18,0,0,0,0,0,0
0,0,22,0,0,0,0,0
0,0,0,14,0,0,0,0
0,0,0,0,21,0,0,0
1,0,0,0,0,30,0,0
0,0,0,0,0,0,28,0
0,0,0,0,0,0,0,43

=== Window-level Normalized Confusion Matrix ===
0.98,0.00,0.00,0.00,0.00,0.00,0.00,0.02
0.00,1.00,0.00,0.00,0.00,0.00,0.00,0.00
0.00,0.00,1.00,0.00,0.00,0.00,0.00,0.00
0.00,0.00,0.00,1.00,0.00,0.00,0.00,0.00
0.00,0.00,0.00,0.00,1.00,0.00,0.00,0.00
0.03,0.00,0.00,0.00,0.00,0.97,0.00,0.00
0.00,0.00,0.00,0.00,0.00,0.00,1.00,0.00
0.00,0.00,0.00,0.00,0.00,0.00,0.00,1.00

=== Individual Sample Confusion Matrix ===
2608,1,12,6,9,1,0,40
0,894,1,25,0,17,0,0
0,3,1690,0,38,0,0,0
7,2,0,677,11,11,0,0
0,1,4,10,1168,0,0,1
19,18,6,3,0,1820,7,4
0,1,0,0,0,7,485,0
23,0,0,8,0,1,0,1639

=== Individual Sample Normalized Confusion Matrix ===
0.97,0.00,0.00,0.00,0.00,0.00,0.00,0.01
0.00,0.95,0.00,0.03,0.00,0.02,0.00,0.00
0.00,0.00,0.98,0.00,0.02,0.00,0.00,0.00
0.01,0.00,0.00,0.96,0.02,0.02,0.00,0.00
0.00,0.00,0.00,0.01,0.99,0.00,0.00,0.00
0.01,0.01,0.00,0.00,0.00,0.97,0.00,0.00
0.00,0.00,0.00,0.00,0.00,0.01,0.98,0.00
0.01,0.00,0.00,0.00,0.00,0.00,0.00,0.98

Confusion matrix image paths:
Window-level: results/test_figs/pointnet2_event_0628_8_ecount_11_window_confusion_matrix_time_window_sec_1.5s_20250911_184937.png
Window-level normalized: results/test_figs/pointnet2_event_0628_8_ecount_11_window_norm_confusion_matrix_1.5s_20250911_184937.png
Individual sample: results/test_figs/pointnet2_event_0628_8_ecount_11_individual_confusion_matrix_1.5s_20250911_184937.png
Individual sample normalized: results/test_figs/pointnet2_event_0628_8_ecount_11_individual_norm_confusion_matrix_1.5s_20250911_184937.png

=== Key Metrics ===
Number of time windows: 230
Number of individual predictions: 11278
Individual sample accuracy: 97.37%
Time window voting accuracy: 99.13%
Accuracy improvement: +1.76%
Prediction time: 45.73 seconds
Pure inference time: 40.1993 seconds
Average inference time per sample: 0.003564 seconds
Inference throughput: 280.55 samples/second

End time: 2025-09-11 18:50:24

=== Results Summary ===
Time window voting accuracy: 99.13%
Individual sample accuracy: 97.37%
Accuracy improvement: +1.76%
Pure inference time: 40.1993 seconds
Average inference time per sample: 0.003564 seconds
Inference throughput: 280.55 samples/second
Log file: results/test_logs/voting_1.5s_20250911_184937.txt
